<ion-header>
	<ion-navbar color="primary">
		<ion-title>Pruebas</ion-title>
		<ion-buttons end>
			<button ion-button icon-only (click)="cerrarSesion()">
				<ion-icon name="log-out"></ion-icon>
			</button>
		</ion-buttons>
	</ion-navbar>
</ion-header>

<ion-content>

    <div class="pin-container" margin>
        <h2 class="title" style="font-weight:bold">Resultados de las pruebas</h2>
        <p class="description">Aquí se mostraran los resultados de todas las pruebas que han sido realizadas.</p>
        <button id="searchButton" ion-button (click)="searchTestResults()" color="primary">
            <p id="actualizarButtonText">Actualizar resultados</p>
        </button>
    </div>

    <div *ngIf="!testFound" class="not-found-message">
        <p>No se ha encontrado ninguna prueba con ese código</p>
    </div>

    <div *ngFor="let userId of usersIds">
        <h6 id="usersIdsText">Usuario: <b>{{userId}}</b></h6>
        <ion-card *ngFor="let result of testsResultsMap[userId]">
            <ion-card-header style="text-align: center;">
                Prueba {{result.muestra_id}}
            </ion-card-header>

            <ion-card-content style="padding-top:10px;">
                <div class="result-container" *ngIf="testStatuses[result.resultado].toLowerCase() == 'terminada'; else enProceso">
                    <span class="result1-label result-text">Estado: </span><span class="result-value value-1 result-text">{{ testStatuses[result.estado] }}</span>
                    <span class="result2-label result-text">Resultado: </span><span class="result-value value-2 result-text">{{ testResults[result.resultado] }}</span>
                    <div class="advice" *ngIf="result['recomendacion'] !== undefined">
                        <p class="advice-title">Recomendación</p>
                        <p class="advice-content">{{ result['recomendacion'] }}</p>
                    </div>
                </div>
                <ng-template #enProceso>
                    <span class="result1-label result-text">Estado: </span><span class="result-value value-1 result-text">{{ testStatuses[result.estado] }}</span>
                </ng-template>
            </ion-card-content>
        </ion-card>
    </div>

</ion-content>

<!-- <h6 id="usersIdsText">Usuario: <b>{{userId}}</b></h6> -->
        <!-- <ion-card *ngFor="let result of testsResultsMap[userId]">
            <ion-card-header style="text-align: center;">
                Prueba {{result.muestra_id}}
            </ion-card-header>

            <ion-card-content style="padding-top:10px;">
                <div class="result-container">
                    <span class="result1-label result-text">Estado: </span><span class="result-value value-1 result-text">{{ testStatuses[result.estado] }}</span>
                    <div *ngIf="testStatuses[result.resultado].toLowerCase() == 'terminada'">
                        <span class="result2-label result-text">Resultado: </span><span class="result-value value-2 result-text">{{ testResults[result.resultado] }}</span>
                        <div class="advice" *ngIf="result['recomendacion'] !== undefined">
                            <p class="advice-title">Recomendación</p>
                            <p class="advice-content">{{ result['recomendacion'] }}</p>
                        </div>
                    </div>
                </div>
            </ion-card-content>
        </ion-card> -->
